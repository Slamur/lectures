# Упражнение. Оценка времени выполнения

## Условие 
Вы написали алгоритм и собираетесь запустить его на вычислительной машине.

Вам известно:
- суммарное количество операций алгоритма;
- количество операций, выполняемых ВМ за секунду.

Для каждого случая оцените, сколько секунд будет выполняться алгоритм.

## Задания

Количество операций алгоритма | Производительность ВМ | Ответ | Комментарий
---|---|---|---
$10^4$ операций | $10^8$ операций / сек | <details> <summary> </summary> $0.0001$ секунды. </details> | <details> <summary> </summary> Настолько малая величина, что вероятнее подготовка программы к запуску будет дольше, чем само время выполнения. </details>
$10^6$ операций | $10^8$ операций / сек | <details> <summary> </summary> $0.01$ секунды. </details> | <details> <summary> </summary> Практически нет разницы с прошлым пунктом. </details>
$5 \cdot 10^7$ операций | $10^8$ операций / сек | <details> <summary> </summary> $0.5$ секунды. </details> | <details> <summary> </summary> Не слишком много, но уже заметно для наблюдателя. </details>
$2 \cdot 10^9$ операций | $5 \cdot 10^8$ операций / сек. | <details> <summary> </summary> $4$ секунды.  </details> | <details> <summary> </summary> В рамках соревнования это может быть критично, но в реальной жизни - вполне адекватное время выполнения. </details>
$10^{10}$ операций | $5 \cdot 10^8$ операций / сек. | <details> <summary> </summary> $20$ секунд.  </details> | <details> <summary> </summary> Для какого-то предпросчета сгодится, но уже придется подождать. </details>
$10^{12}$ операций | $2 \cdot 10^9$ операций / сек. | <details> <summary> </summary> $500$ секунд - около 8-9 минут. </details> | <details> <summary> </summary> Обратите внимание, что специально взят очень "оптимистичный" вариант скорости выполнения. </details>
$10^{18}$ операций | $2 \cdot 10^9$ операций / сек. | <details> <summary> </summary> $5 \cdot 10^8$ секунд - почти 16 лет. </details> | <details> <summary> </summary> Комментарии излишни. </details>

# Упражнение. О большое и асимптотика.

## Условие 
Алиса придумала алгоритм и определила функцию $T(N)$, задающую **количество операций** алгоритма для заданных входных данных.

Боб высказал предположение, что **асимптотика** описанного Алисой алгоритма описывается функцией $F(N)$.

Для каждого случая выберите один из вариантов:

- $T(N)$ = $\Theta(F(N))$;
- $T(N) = O(F(N))$, но $T(N) \ne \Omega(F(N))$;
- $T(N) = \Omega(F(N))$, но $T(N) \ne O(F(N))$.

## Задания

Все переменные в заданиях обозначают целые положительные числа (если иное не указано явно).

$T(N)$ | $F(N)$ | Ответ | Комментарий
---|---|---|---
$\log_A{N}$ | $\log_B{N}$ | <details> <summary> </summary> $\Theta$ </details> | <details> <summary> </summary> По свойствам логарифмов $\log_A{N} = \log_B{N} \cdot \log_A{B}$. <br> Так как $\log_A{B}$ не зависит от $N$, то $\log_A{N} = O(\log_B{N})$ и наоборот. <br> Поэтому при записи асимптотики обычно используют логарифм без основания $O(\log{N})$ </details>
$A^N$ | $B^N$ | <details> <summary> </summary> Если $A < B$, то $A^N = O(B^N)$, но $A^N \ne \Omega(B^N)$ </details> | <details> <summary> </summary> Пусть $A < B$. <br> $A^N \le 1 \cdot B^N$ для $N \ge 0$ по свойствам степеней положительных целых чисел. <br> Обратное же неверно: допустим, что $B^N \le C \cdot A^N$ для всех $N \ge N_0$. <br> В таком случае $1 < (\frac{B}{A})^N \le C$, откуда $N \le \log{C}$ по основанию $\frac{B}{A}$. </details>
$D + 2 \cdot D + \dots + N$ <br> При условии $N = K \cdot D$ | $\frac{N^2}{D}$ | <details> <summary> </summary> $\Theta$ </details> | <details> <summary> </summary> $K = \frac{N}{D}$ <br> Сумма **арифметической прогрессии** равна $(A_1 + A_K) \cdot \frac{K}{2}$ <br> $A_1 = D$, $A_K = N$, получаем $(N + D) \cdot \frac{N}{2 \cdot D} = O(\frac{N^2}{D})$. </details>
$\frac{N}{1} + \frac{N}{A} + \frac{N}{A^2} + \dots + \frac{N}{A^K}$ <br> $A > 1$ | $N$ | <details> <summary> </summary> $\Theta$ </details> | <details> <summary> </summary> Сумма **убывающей геометрической прогрессии** при возрастании $K$ стремится к $\frac{B}{1 - Q}$ <br> $B = N$, $Q = \frac{1}{A}$, получаем $N \cdot \frac{A}{A - 1}$ <br> Так как $\frac{A}{A - 1} \le 2$ для $A \ge 2$, то вся сумма не превышает $2 \cdot N$, то есть равна $O(N)$.</details>
$N \cdot N!$ | $N!$ | <details> <summary> </summary> $N \cdot N! = \Omega(N!)$, но $N \cdot N! \ne O(N!)$ </details> | <details> <summary> </summary> Допустим, что $N \cdot N! \le C \cdot N!$ для всех $N \ge N_0$. <br> Из этого напрямую следует, что $N \le C$. <br> В то же время $N! \le 1 \cdot N \cdot N!$ для всех $N \ge 1$. </details>

# Упражнение. Непростые доказательства.

## Условие 
Докажите представленные тождества.

## Задания

- $\frac{1}{1} + \frac{1}{2} + \frac{1}{3} + \dots + \frac{1}{N} = \Theta(\log{N})$;

**Доказательство**
<details> <summary> </summary> 

Пусть $g(i) = \log_2{i}$.
Обозначим через $f(i) = 2^{\lfloor{g(i)}\rfloor}$ и $c(i) = 2 \cdot f(i)$. 

Рассмотрим две последовательности:

- $a_i = \frac{1}{f(i)}$;
- $b_i = \frac{1}{c(i)}$.

Заметим, что для $i \ge 1$ верно: $b_i \le \frac{1}{i} \le a_i$.

Отсюда следует, что $\sum{b_i} \le \sum{\frac{1}{i}} \le \sum{a_i}$ для $i = 1 \dots N$.

Оценим $\sum{b_i}$ и $\sum{a_i}$.

Разобьём все $b_i$ и $a_i$ на блоки с одинаковыми знаменателями.

Сумма каждого целого блока равна $\frac{1}{2}$ для $b$ и $1$ для $a$, а количество блоков равно $\lceil{g(N)}\rceil$.

Отсюда следует, что для $i = 1 \dots N$

- $\frac{1}{2} \cdot \lfloor{g(N)}\rfloor \le \sum{b_i}$;
- $\sum{a_i} \le \lceil{g(N)}\rceil$.

Мы показали, что $\frac{1}{2} \cdot \lfloor{\log_2{N}}\rfloor \le \sum{\frac{1}{i}} \le \lceil{\log_2{N}}\rceil$.

</details>

- $\log_A{N!} = \Theta(N \log{N})$ при $A > 1$;

**Доказательство**

<details> <summary> </summary> 

Верхняя оценка: 

- $\log_A{N!} = \log_A{1} + \log_A{2} + \dots + \log_A{N}$;
- $\log_A{i} \le \log_A{N}$ для $i \le N$;
- Получаем $\log_A{N!} \le N \cdot log_A{N}$.

Нижняя оценка: 

- $\log_A{1} + \log_A{2} + \dots + \log_A{\frac{N}{2}} + \dots + \log_A{N} \ge \log_A{\frac{N}{2}} + \dots + \log_A{N}$;
- $\log_A{\frac{N}{2}} + \dots + \log_A{N} \ge \frac{N}{2} \cdot \log_A{\frac{N}{2}}$;
- $\log_A{\frac{N}{2}} = \log_A{N} - \log_A{2}$;
- Получаем $\log_A{N!} \ge \frac{N}{2} \cdot (\log_A{N} - \log_A{2})$.

</details>

# Упражнение. Асимптотика по коду

## Условие

Оцените асимптотику представленного псевдокода.

## Задания

1. Три похожих кода

```
    Для i от 1 до N {
      Для j от 1 до N {
        Вывести (i, j)
      }
    }

    Для i от 1 до N {
      Для j от 1 до i {
        Вывести (i, j)
      }
    }

    Для i от 1 до N {
      Для j от i до N {
        Вывести (i, j)
      }
    }
```

**Ответ**

<details> <summary> </summary> 

Первый код выполняет $O(N \cdot N) = O(N^2)$ итераций.

Количество итераций второго и третьего представляет из себя арифметическую прогрессию $1 + 2 + \dots + N$, которая равна $\frac{(N + 1) \cdot N}{2} = O(N^2)$.
</details>

2. Пары индексов

Пусть дан массив $A_1 \le A_2 \le \dots \le A_N$.

```
    j = 1
    Для i от 1 до N {
      Пока (j <= N) и (A[i] * 2 > A[j]) {
        j = j + 1
      }
      Вывести(i, j)
    }
```

**Ответ**

<details> <summary> </summary> 
  
Обе переменные $i$ и $j$ пройдут по разу все значения от $1$ до $N$.

Итоговое количество итераций равно $O(N + N) = O(N)$.
</details>

3. Цикл с делением

```
    Пока (N > 0) {
        rem = (остаток от деления N на 2)
        Вывести(rem)
        Если (rem равен 1) {
            N = N - rem
        } Иначе {
            N = N / 2
        }
    }
```

**Ответ**

<details> <summary> </summary> 

Рассмотрим двоичную запись числа $N$, в ней $\lceil{\log_2{N}}\rceil$ разрядов.

На каждой итерации происходит следующее:

- Если младший разряд $N$ равен $1$, то он превращается в $0$ (вычитание).
- Если младший разряд $N$ равен $0$, то он отбрасывается (деление на 2).

На каждый разряд приходится не более двух итераций, поэтому в сумме получается не более $2 \cdot \log_2{N} = O(\log{N})$ итераций.
</details>

5. Рекурсивная функция

```
    Функция f(mask, len) {
      Если (len равен 0) {
        Вывести(mask)
      } Иначе {
        f(mask * 2, len - 1)
        f(mask * 2 + 1, len - 1)
      }
    }

    Вызываем f(0, N)
```

**Ответ**

<details> <summary> </summary> 

Для фиксированного значения параметра $len$ существует $2^{N - len}$ вариантов параметров $mask$.

Отсюда следует, что суммарное количество вызовов функции равно $\sum{2^{N - i}}$ для $i = 0 \dots N$, что равняется $2^{N + 1} - 1 = O(2^N)$.
  
</details>

5. В поисках квадрата

```
    i = N
    Пока (i не является полным квадратом) {
      i = i - 1
    }

    Вывести(i)
```

**Ответ**

<details> <summary> </summary> 
  
Пусть $N = (K + 1)^2 - A \ge K^2$.

В таком случае $i$ пройдёт все значения от $N$ до $K^2$.

Итоговое количество итераций равно $N - K^2 \le (K + 1)^2 - K^2 = 2 \cdot K + 1 = O(K) = O(\sqrt{N})$.
</details>

6. Кратные числа

```
    Для d от 1 до M
      j = d
      Пока (j <= N) {
        Вывести(j)
        j = j + d
      }
    }
```

**Ответ**

<details> <summary> </summary> 

Для фиксированного $d$ будет сделано $\lfloor{\frac{N}{d}}\rfloor$ итераций.

В сумме получается $M$ итераций внешнего цикла и $\frac{N}{1} + \frac{N}{2} + \dots + \frac{N}{M}$ итераций внутреннего, что равно $O(M + N \cdot \log{M})$ по свойствам гармонического ряда.
  
</details>

7. Сокращаем отрезок

```
    left = 1
    right = N

    Пока (left <= right) {
        odd = 0
        even = 0

        Для i от left до right {
            Вывести(i)
        
            Если (i чётная) то {
                even = even + 1
            } Иначе {
                odd = odd + 1
            }
        }

        Если (odd > even) {
            left = left + odd
        } Иначе {
            right = right - even
        }
    }
```

**Ответ**

<details> <summary> </summary> 

На каждой итерации вычисляется количество чётных ($even$) и нечётных ($odd$) чисел в отрезке $[left; right]$.

После вычисления одна из границ отрезка сдвигается на $\max(odd, even)$.

Обозначим длину отрезка через $N = right - left + 1$.

По построению $N = odd + even = \min(odd, even) + \max(odd, even)$, то есть после вычитания длина отрезка становится равна $\min(odd, even)$.

Легко понять, что $\min(odd, even) = \lfloor{\frac{N}{2}}\rfloor$.

То есть после каждой итерации длина отрезка $[left; right]$ сокращается вдвое.

Из этого следует, что суммарно произойдёт $N + \lfloor{\frac{N}{2}}\rfloor + \lfloor{\frac{N}{4}}\rfloor + \dots + 1$. 

По свойству убывающей геометрической прогрессии данная сумма не превосходит $2 \cdot N$, то есть будет выполнено $O(N)$ итераций.
</details>
