# Эффективность алгоритма

Представим ситуацию: вы прочли задачу и быстро придумали к ней простой алгоритм решения. Реализовали его на любимом ЯП, после чего отправили в тестирующую систему.

И получили вердикт "Превышено ограничение времени"...

Чаще всего это связано с недостаточной **эффективностью** вашего алгоритма.

Но как вы должны были это понять?! Как вы могли до написания и отправки кода в систему понять, что ваше решение выйдет за ограничения по времени?

**Ответ**: оценить количество простых операций.

## Простые операции и скорость их выполнения

Одной из важных характеристик компьютера является **тактовая частота** процессора (измеряется в герцах).

Эта величина показывает, сколько "тактов" успевает обработать процессор за одну секунду.

По сути такты - это единицы дискретного времени для процессора.

Современные процессоры выполняют **миллиарды тактов** в секунду (то есть их тактовая частота измеряется уже в **гига**герцах).

### Одна операция - несколько тактов

Такт является элементарной единицей выполнения, за которую выполняются базовые машинные операции.

Но одна операция в вашем ЯП не всегда совпадает с одной машинной операцией.

Поэтому часто используется оценка в $10^8$ операций за секунду. Обратите внимание, что это не четкое ограничение - это по сути порядок величин, на который можно ориентироваться.

**Важно**: у всех ЯП различная производительность. Например, для Python рекомендуется в большинстве случаев ориентироваться на порядок $10^7$ операций. 

### И что делать с этими количествами?

Если для вашего алгоритма существует тест с наибольшим числом операций - авторы задачи постараются его добавить в набор. 

Соответственно дальнейшие рассуждения будут производиться относительно **худшего случая** для вашего алгоритма.

В идеале порядок количества операций должен быть меньше максимального на 1-2 - тогда вам не придется думать о более точной оценке, и так будет понятно, что работает быстро. 

С другой стороны, что если программа выполняет порядка $10^{12}$ операций, то в секунду она не уложится никак, да и в 2 секунды тоже.

## Асимптотика - оценка эффективности

Допустим, что у нас есть алгоритм, зависящий от одного целого числа $N$.

Обозначим через $T(N)$ функцию, вычисляющую количество операций нашего алгоритма для заданного $N$.

В большинстве случаев вычислять или определять конкретное значение $T(N)$ является затратным и не особо полезным.

Поэтому в программировании стараются использовать **оценку** количества операций - ведь зачастую вам важен лишь порядок, а не точное число.

### "О большое"

Введём **обозначение**: для какой-либо функции $F(N)$ будем говорить, что $T(N) = O(F(N))$,

если существуют такие константы $C > 0$ и $N_0 \ge 0$, что $T(N) \le C \cdot F(N)$ для всех $N \ge N_0$.

По сути “О большое” является обозначением **оценки сверху** для функции $T(N)$ через функцию $F(N)$. 

#### А если у алгоритма несколько параметров?

В общем случае можно считать, что "О большое" должно работать для каждого параметра независимо (или для какой-либо их комбинации).

Соответственно, в дальнейшем под $N$ будет пониматься любой набор числовых параметров алгоритма $N_1, N_2, \dots, N_k$.

#### Другие обозначения

Аналогично "О большому" существуют обозначения для других видов оценки - [таблица в статье](https://ru.wikipedia.org/wiki/«O»_большое_и_«o»_малое) Википедии.

### Определение асимптотики

Будем называть функцию $F(N)$ **асимптотикой** алгоритма с количеством операций $T(N)$, если 

- $T(N) = O(F(N))$, 
- $F(N) = O(T(N))$ (иногда нет, но это очень узкие случаи), 
- $F(N)$ содержит лишь **несравнимые** слагаемые.
- Коэффициенты при слагаемых равны $1$.
- $F(N)$ не содержит слагаемых и множителей, не зависящих от параметров алгоритма (если у вас такие есть, то сделайте их параметрами).

**Определение**: Слагаемые $X(N)$ и $Y(N)$ назовём **несравнимыми**, если 

- $X(N) \ne O(Y(N))$
- $Y(N) \ne O(X(N))$

### Зачем нужна асимптотика?

В качестве асимптотики $F(N)$ зачастую берутся простые для вычисления функции.

Соответственно, подставляя в данную функцию значения параметров алгоритма $N$, вы можете **оценить** ожидаемое количество операций без сложных вычислений и анализа.

Оценка позволит вам понять, насколько вероятно ваше решение пройдет заданные ограничения по времени и памяти (зачастую или "точно пройдет", или "точно не пройдет").

## Упражнение 1: является ли F(N) асимптотикой для T(N)?

Постарайтесь не только дать ответы "да" или "нет", но еще и обосновать причину своего ответа.

При ответе "да" попробуйте предложить константу $C$ и соответствующие ей значения параметров $N_0$, $M_0$ и т.д.

При ответе "нет" явно покажите, какому / каким пунктам из определения не соответствуют функции.

### Задание 1. Один параметр

- $T(N) = 3 \cdot N^2 + 2$
- $F(N) = N^2$

#### Ответ 

<details> <summary> </summary>

$F(N)$ **является** асимптотикой алгоритма с количеством операций $T(N)$.

#### Доказательство
- $T(N) = O(F(N))$ - существуют $C = 4$ и $N_0 = 2$ такие. что $(3 \cdot N^2 + 2) \le 4 \cdot N^2$ для $N \ge 2$.
- $F(N) = O(T(N))$ - существуют $C = 1$ и $N_0 = 1$ такие, что $N^2 \le 1 \cdot (3 \cdot N^2 + 2)$ для $N \ge 1$.
- Коэффициент при слагаемом $N^2$ равен $1$.
  
</details>

### Задание 2. Один параметр, но посложнее

- $T(N) = 3 \cdot N^2 + 50 \cdot N + 200$
- $F(N) = N^2$

#### Ответ 

<details> <summary> </summary>
	
$F(N)$ **является** асимптотикой алгоритма с количеством операций $T(N)$.

#### Доказательство:

Выберем $C = 4$ и найдём $N_0$:

- $3 \cdot N^2 + 50 \cdot N + 200 \le 4N^2$
- $N^2 - 50 \cdot N - 200 \ge 0$
- $D = 25^2 + 200 = 825$
- $N \ge (25 + \sqrt{D}) > 53$

Откуда следует, что для $C = 4$ неравенство $3 \cdot N^2 + 50 \cdot N + 200 \le 4N^2$ верно для $N \le 54$. 

**Проверка**: $T(54) = 11648 \le C \cdot F(54) = 4 \cdot 54^2 = 11664$.

#### Примечание

Асимптотика говорит о поведении функции при стремлении параметров к граничным (бесконечным) значениям.

На мелких значениях параметров (в данном примере $N < 54$) оценка сверху может не выполняться.

Это нормально, так как вопрос об эффективности ставится только для случаев, близких по порядку значений к ограничениям.

</details>

### Задание 3. Два параметра

- $T(N, M) = N^2 + 3 \cdot M \cdot N + \frac{M^3}{10} + 100 \cdot M^2 + 20$
- $F(N, M) = N^2 + M \cdot N + M^3$

#### Ответ 

<details> <summary> </summary>
	
$F(N, M)$ **является** асимптотикой алгоритма с количеством операций $T(N)$.

#### Доказательство

- $T(N, M) = O(F(N, M))$ - существуют $C = 3$, $N_0 = 1$ и $M_0 = 100$ такие, что

  $N^2 + 3 \cdot M \cdot N + \frac{M^3}{10} + 100 \cdot M^2 + 20 \le 4 \cdot (N^2 + M \cdot N + M^3)$ для $N \ge 1$ и $M \ge 100$.
  
- $F(N, M) = O(T(N, M))$ - cуществуют $C = 10$, $N_0 = 1$, $M_0 = 1$ такие, что

  $N^2 + M \cdot N + M^3 \le 10 \cdot (N^2 + 3 \cdot M \cdot N + \frac{M^3}{10} + 100 \cdot M^2 + 20)$ для $N \ge 1$ и $M \ge 1$.
  
- Коэффициенты при слагаемых $N^2$, $M \dot N$, $M^3$ равны $1$; 
- $M^3$ сравнимо с $M^2$, поэтому $M^2$ не включено в $F(N, M)$.
- $20$ не зависит от параметров, поэтому $20$ не включено в $F(N, M)$.

#### Примечание

Можно заметить, что 

- если $M \le N$, то $M \cdot N \le N^2$;
- если $N \le M$, то $M \cdot N \le M^3$.

Из чего можно сделать вывод, что на самом деле $F(N, M) = N^2 + M^3$. 

Да, такая оценка возможна, но в большинстве случаев вам будет достаточно простого способа анализа, приведенного в примере.

</details>

### Задание 4

- $T(N) = 3 \cdot N^2 + 2$
- $F(N) = N^3$

#### Ответ 

<details> <summary> </summary>

$F(N)$ **не является** асимптотикой для алгоритма с количеством операций $T(N)$.

#### Доказательство:

$F(N) \ne O(T(N))$ - для всех $C \ge 0$ неравенство $N^3 \le C \cdot (3 \cdot N^2 + 2)$ выполняется только для $N \le 3 \cdot C$.

</details>

### Задание 5

- $T(N) = 3 \cdot N^2 + 2$
- $F(N) = N$

#### Ответ 

<details> <summary> </summary>

$F(N)$ **не является** асимптотикой для алгоритма с количеством операций $T(N)$.

#### Доказательство

$T(N) \ne O(F(N))$ - для всех $C \ge 0$ неравенство $(3 \cdot N^2 + 2) \le С \cdot N$ выполняется только для $N \le 3 \cdot C$. 

</details>

### Задание 6

- $T(N) = 3 \cdot N^2 + 2$
- $F(N) = 2 \cdot N^2$

#### Ответ 

<details> <summary> </summary>
	
$F(N)$ **не является** асимптотикой для алгоритма с количеством операций $T(N)$.

#### Доказательство

Коэффициент при слагаемом $N^2$ равен $2 \ne 1$

</details>

### Задание 7
- $T(N) = 3 \cdot N^2 + 2$
- $F(N) = N^2 + N$

#### Ответ 

<details> <summary> </summary>
	
$F(N)$ **не является** асимптотикой для алгоритма с количеством операций $T(N)$.

#### Доказательство

$F(N)$ содержит сравнимые слагаемые $N^2$ и $N$, так как $N = O(N^2)$.

</details>
